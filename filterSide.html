<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projekt 7 - shopAholics</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono&display=swap" rel="stylesheet">

</head>

<div class="menu">

    <a href="index.html">STARTSIDE</a>
    <a href="filterSide.html">SIDER</a>
    <a href="om.html">OM</a>
    <a href="portfolio.html">KONTAKT</a>

</div>

<body>
    <header>

        <img src="logo/logo.svg" alt="logo">


    </header>

    <div id="sectionwrapper">
        <nav>
            <div class="filter_kategori">
                <button class="filter" data-kategori="alle">Alle</button>
                <button class="filter" data-kategori="tøj">Tøj</button>
                <button class="filter" data-kategori="sko">Sko</button>
                <button class="filter" data-kategori="bolig">Bolig</button></div>

            <div class="filter_ekstra">
                <button class="filter_køn" data-køn="begge">Begge</button>
                <button class="filter_køn" data-køn="mand">Mænd</button>
                <button class="filter_køn" data-køn="kvinde">Kvinder</button></div>

        </nav>



        <div id="templateModtager"></div>

        <template id="site_template">

            <div id="popup">
                <button class="lukpopup">X</button>
                <section class="indhold">

                    <article class="enkeltSite">
                        <h2></h2>

                        <img class="billede" src="">
                        <br>
                        <a href="" target="_blank">
                            Gå til siden her
                        </a>

                        <p></p>
                    </article>




                </section>
            </div>

            <article class="container">
                <h2 class="navn"></h2>
                <img class="billede1" src="">
                <p class="info"></p>
            </article>
        </template>

    </div>

    <footer>
        <div class="footer_boks">
            <p class="footer_tekst_1">E-mail: shopaholics@none.com</p>
            <p class="footer_tekst_2">Telfnr.: 12 34 56 78</p>
        </div>
    </footer>

    <section id="liste"></section>

    <script>
        let alleSites;
        const dest = document.querySelector("#templateModtager");
        const temp = document.querySelector("#site_template");
        let filter = "alle";
        let køn = "begge";

        document.addEventListener("DOMContentLoaded", getJson);

        async function getJson() {
            let jsonData = await fetch("https://spreadsheets.google.com/feeds/list/1Zq4nXm7sL2Vz-tsqLB3qSKQFgW6RReynNH7SS47RqWw/od6/public/values?alt=json");

            // console.log("jsonData", jsonData);

            alleSites = await jsonData.json();
            // console.log("alleSites", alleSites);
            visSites();
        }

        function visSites() {
            console.log("filter", filter);
            console.log("køn", køn);
            dest.innerHTML = "";
            alleSites.feed.entry.forEach(site => {
                if ((filter == "alle" || filter == site.gsx$kategori.$t) && (køn == "begge" || køn == site.gsx$underkategori.$t)) {

                    const klon = temp.cloneNode(true).content;
                    klon.querySelector(".navn").textContent = site.gsx$navn.$t;
                    klon.querySelector(".billede1").src = "img/" + site.gsx$billede.$t + ".png";
                    dest.appendChild(klon);

                    dest.lastElementChild.addEventListener("click", () => {
                        visSingle(site)
                    });

                    addEventlistenertoButtons();
                }
            })
        }

        function addEventlistenertoButtons() {
            document.querySelectorAll(".filter").forEach(elm => {
                elm.addEventListener("click", filtrering);
            })

            document.querySelectorAll(".filter_køn").forEach(elm => {
                elm.addEventListener("click", filtrering_køn);
            })

            // console.log("klik knap", addEventlistenertoButtons);
        }

        function filtrering() {
            filter = this.dataset.kategori;
            køn = "begge";
            visSites();
            //console.log("filtrering sker", filtrering);
        }

        function filtrering_køn() {
            køn = this.dataset.køn;
            visSites();
            // console.log("filtrering_køn sker", filtrering_køn);
        }

        function visSingle(site) {
            document.querySelector("#popup").style.display = "block";
            document.querySelector("#popup .lukpopup").addEventListener("click", lukSingle);

            document.querySelector(".enkeltSite h2").textContent = site.gsx$navn.$t;
            document.querySelector(".enkeltSite .billede").src = "img/" + site.gsx$billede.$t + ".png";
            document.querySelector(".enkeltSite a").href = site.gsx$hjemmeside.$t;
            document.querySelector(".enkeltSite p").textContent = site.gsx$tekst.$t;
            console.log("visSingle", visSingle);
        }

        function lukSingle() {
            document.querySelector("#popup").style.display = "none";
        }
    </script>


</body></html>
